class OtBase extends HTMLElement{#e=!1;connectedCallback(){this.#e||(document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>this.#t(),{once:!0}):this.#t())}#t(){this.#e||(this.#e=!0,this.init())}disconnectedCallback(){this.cleanup()}cleanup(){}handleEvent(t){const e=this[`on${t.type}`];e&&e.call(this,t)}keyNav(t,e,i,s,r,h=!1){const{key:a}=t;let n=-1;return a===r?n=(e+1)%i:a===s?n=(e-1+i)%i:h&&(a==="Home"?n=0:a==="End"&&(n=i-1)),n>=0&&t.preventDefault(),n}emit(t,e=null){return this.dispatchEvent(new CustomEvent(t,{bubbles:!0,composed:!0,cancelable:!0,detail:e}))}$(t){return this.querySelector(t)}$$(t){return Array.from(this.querySelectorAll(t))}uid(){return Math.random().toString(36).slice(2,10)}}typeof window<"u"&&(window.OtBase=OtBase),"commandForElement"in HTMLButtonElement.prototype||document.addEventListener("click",o=>{const t=o.target.closest("button[commandfor]");if(!t)return;const e=document.getElementById(t.getAttribute("commandfor"));if(!e)return;const i=t.getAttribute("command")||"toggle";e instanceof HTMLDialogElement&&(i==="show-modal"?e.showModal():i==="close"||e.open?e.close():e.showModal())});class OtCarousel extends OtBase{#e;#t=[];#m;#b;#s;#l=[];#i=0;#h=0;#n;#r=null;#c=0;#d=0;#f=0;init(){if(this.#e=this.$(":scope > [data-carousel-track]"),this.#t=this.#e?[...this.#e.children]:[],!this.#e||this.#t.length===0){console.warn("ot-carousel: Missing [data-carousel-track] with slide elements");return}this.setAttribute("role","region"),this.setAttribute("aria-roledescription","carousel"),this.setAttribute("aria-live","off"),this.setAttribute("tabindex",this.getAttribute("tabindex")||"0"),this.setAttribute("aria-label",this.getAttribute("aria-label")||"Carousel"),this.#m=this.$(":scope > [data-carousel-prev]")||this.#p("prev"),this.#b=this.$(":scope > [data-carousel-next]")||this.#p("next"),this.#s=this.$(":scope > [data-carousel-dots]")||this.#v(),this.#t.forEach((t,e)=>{t.dataset.carouselSlide||="",t.setAttribute("role","group"),t.setAttribute("aria-roledescription","slide"),t.setAttribute("aria-label",`${e+1} of ${this.#t.length}`)}),this.#y(),this.#u(this.#g(),!1,!0),this.#h=Number.parseInt(this.getAttribute("autoplay")||"0",10),this.#t.length<2?this.dataset.carouselSingle="":(delete this.dataset.carouselSingle,this.#a()),this.addEventListener("click",this),this.addEventListener("keydown",this),this.addEventListener("mouseenter",this),this.addEventListener("mouseleave",this),this.addEventListener("focusin",this),this.addEventListener("focusout",this),this.addEventListener("wheel",this,{passive:!1}),this.#e.addEventListener("pointerdown",this),this.#e.addEventListener("pointerup",this),this.#e.addEventListener("pointercancel",this)}cleanup(){this.#o()}onclick(t){const e=t.target.closest("[data-carousel-prev], [data-carousel-next], [data-carousel-dot]");if(!e||!this.contains(e))return;if(e.hasAttribute("data-carousel-prev")){this.prev();return}if(e.hasAttribute("data-carousel-next")){this.next();return}const i=Number.parseInt(e.dataset.index||"-1",10);i>=0&&this.goTo(i)}onkeydown(t){if(!(t.altKey||t.ctrlKey||t.metaKey)){if(t.key==="ArrowLeft"){t.preventDefault(),this.prev();return}if(t.key==="ArrowRight"){t.preventDefault(),this.next();return}if(t.key==="Home"){t.preventDefault(),this.goTo(0);return}t.key==="End"&&(t.preventDefault(),this.goTo(this.#t.length-1))}}onmouseenter(){this.#o()}onmouseleave(){this.#a()}onfocusin(){this.#o()}onfocusout(t){this.contains(t.relatedTarget)||this.#a()}onpointerdown(t){this.#t.length<2||t.pointerType==="mouse"&&t.button!==0||(this.#r=t.pointerId,this.#c=t.clientX,this.#d=t.clientY,this.#e.setPointerCapture?.(t.pointerId))}onpointerup(t){if(t.pointerId!==this.#r)return;const e=t.clientX-this.#c,i=t.clientY-this.#d;this.#r=null,!(Math.abs(e)<40||Math.abs(e)<Math.abs(i))&&(e>0?this.prev():this.next())}onpointercancel(){this.#r=null}onwheel(t){if(this.#t.length<2)return;const e=performance.now();if(e<this.#f)return;const i=Math.abs(t.deltaY)>=Math.abs(t.deltaX)?t.deltaY:t.deltaX;Math.abs(i)<18||(t.preventDefault(),this.#f=e+220,i>0?this.next():this.prev())}next(){return this.goTo(this.#i+1)}prev(){return this.goTo(this.#i-1)}goTo(t){const e=this.#u(t,!0,!1);return e&&this.#E(),e}get activeIndex(){return this.#i}set activeIndex(t){this.goTo(t)}#g(){const t=Number.parseInt(this.getAttribute("start")||"0",10);return Number.isNaN(t)?0:Math.max(0,Math.min(t,this.#t.length-1))}#u(t,e=!0,i=!1){if(!this.#t.length)return!1;const s=this.#t.length,r=(t%s+s)%s;return!(r!==this.#i)&&!i?!1:(this.#i=r,this.#e.style.transform=`translateX(-${r*100}%)`,this.#e.setAttribute("aria-label",`Slide ${r+1} of ${s}`),this.#t.forEach((a,n)=>{const l=n===r;a.setAttribute("aria-hidden",String(!l))}),this.#l.forEach((a,n)=>{const l=n===r;a.setAttribute("aria-current",l?"true":"false"),a.ariaLabel=`Go to slide ${n+1}`}),e&&this.emit("ot-carousel-change",{index:r,slide:this.#t[r]}),!0)}#p(t){const e=document.createElement("button");return e.type="button",t==="prev"?(e.dataset.carouselPrev="",e.setAttribute("aria-label","Previous slide"),e.innerHTML="&#x2039;"):(e.dataset.carouselNext="",e.setAttribute("aria-label","Next slide"),e.innerHTML="&#x203a;"),this.append(e),e}#v(){const t=document.createElement("nav");return t.dataset.carouselDots="",t.setAttribute("aria-label","Slide navigation"),this.append(t),t}#y(){const t=[...this.#s.querySelectorAll("[data-carousel-dot]")],e=this.#t.length;if(t.length>e&&t.slice(e).forEach(i=>i.remove()),t.length<e)for(let i=t.length;i<e;i++){const s=document.createElement("button");s.type="button",s.dataset.carouselDot="",s.dataset.index=String(i),this.#s.append(s)}this.#l=[...this.#s.querySelectorAll("[data-carousel-dot]")].slice(0,e),this.#l.forEach((i,s)=>{i instanceof HTMLButtonElement&&(i.type="button"),i.dataset.index=String(s),i.setAttribute("aria-label",`Go to slide ${s+1}`)})}#a(){this.#o(),!(this.#h<=0||this.#t.length<2)&&(window.matchMedia("(prefers-reduced-motion: reduce)").matches||this.matches(":hover")||this.contains(document.activeElement)||(this.#n=setInterval(()=>{this.#u(this.#i+1,!0,!1)},this.#h)))}#o(){this.#n&&(clearInterval(this.#n),this.#n=null)}#E(){this.#a()}}customElements.define("ot-carousel",OtCarousel);
